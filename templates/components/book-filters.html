{% load get_item %}
<form x-cloak x-show="openFilters" id="ajax-filters-form" x-init x-target.replace="ajax-filter-toggle ajax-filter-toggle ajax-filters-form ajax-books ajax-filters ajax-pagination" method="get" action="{% url 'status' status.slug %}" @change="$el.requestSubmit()" x-transition>
  <dl id="ajax-filters" class="filters">
    <div>
      <dt>Types</dt>
      <dd>
        <div>
          <label>
            <input type="radio" name="type" value="all" {% if filter_queries.type %}checked{% endif %}>
            All
          </label>
        </div>
        <div>
          <label>
            <input type="radio" name="type" value="textual" {% if filter_queries.type == 'textual' %}checked{% endif %}>
            Textual
            (<span>{{ filter_counts.type.textual|get_item:'count' }}</span>)
          </label>
        </div>
        <div>
          <label>
            <input type="radio" name="type" value="visual" {% if filter_queries.type == 'visual' %}checked{% endif %}>
            Visual
            (<span>{{ filter_counts.type.visual|get_item:'count' }}</span>)
          </label>
          <div class="sub-filters">
            <label>
              <input type="radio" name="type" value="comic" {% if filter_queries.type == 'comic' %}checked{% endif %}>
              Comics
              (<span>{{ filter_counts.type.visual|get_item:'sub_items'|get_item:'comic' }}</span>)
            </label>
            <label>
              <input type="radio" name="type" value="photo" {% if filter_queries.type == 'photo' %}checked{% endif %}>
              Photo Books
              (<span>{{ filter_counts.type.visual|get_item:'sub_items'|get_item:'photo' }}</span>)
            </label>
            <label>
              <input type="radio" name="type" value="picture" {% if filter_queries.type == 'picture' %}checked{% endif %}>
              Picture Books
              (<span>{{ filter_counts.type.visual|get_item:'sub_items'|get_item:'picture' }}</span>)
            </label>
          </div>
        </div>
      </dd>
    </div>
    <div>
      <dt>Genres</dt>
      <dd>
        <div>
          <label>
            <input type="radio" name="genre" value="all" {% if filter_queries.genre == 'all' %}checked{% endif %}>
            All
          </label>
        </div>
        {% for genre in genres %}
          {% if not genre.parent %}
            <div>
              <label>
                <input type="radio" name="genre" value="{{ genre.slug }}" {% if genre.slug == filter_queries.genre %}checked{% endif %}>
                {{ genre.name }}
                (<span>{{ filter_counts.genre|get_item:genre.slug|get_item:'count' }}</span>)
              </label>
              {% if has_sub_genres|get_item:genre.slug %}
                <div class="sub-filters">
                  {% for sub_genre in genres %}
                    {% if sub_genre.parent == genre %}
                      <label>
                        <input type="radio" name="genre" value="{{ sub_genre.slug }}" {% if sub_genre.slug == filter_queries.genre %}checked{% endif %}>
                        {{ sub_genre.name }}
                        (<span>{{ filter_counts.genre|get_item:genre.slug|get_item:'sub_items'|get_item:sub_genre.slug }}</span>)
                      </label>
                    {% endif %}
                  {% endfor %}
                </div>{# / Sub genre #}
              {% endif %}
            </div>{# / Parent genre #}
          {% endif %}
        {% endfor %}
      </dd>
    </div>
    {% if status.slug != 'wishlist' %}
      <div>
        <dt>Formats</dt>
        <dd>
          <div>
            <label>
              <input type="radio" name="format" value="all" {% if filter_queries.format == 'all' %}checked{% endif %}>
              All
            </label>
          </div>
          {% for format in formats %}
            <div>
              <label>
                <input type="radio" name="format" value="{{ format.slug }}" {% if format.slug == filter_queries.format %}checked{% endif %}>
                {{ format.name }}
                (<span>{{ filter_counts.format|get_item:format.slug }}</span>)
              </label>
            </div>
          {% endfor %}
        </dd>
      </div>
      <div>
        <dt>Locations</dt>
        <dd>
          <div>
            <label>
              <input type="radio" name="location" value="all" {% if filter_queries.location == 'all' %}checked{% endif %}>
              All
            </label>
          </div>
          {% for location in locations %}
            <div>
              <label>
                <input type="radio" name="location" value="{{ location.slug }}" {% if location.slug in filter_queries.location %}checked{% endif %}>
                {{ location.name }}
                (<span>{{ filter_counts.location|get_item:location.slug }}</span>)
              </label>
            </div>
          {% endfor %}
        </dd>
      </div>
    {% endif %}
  </dl>
</form>
